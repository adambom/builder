builder
=======

One build script to rule them all

# Setup and usage

First, you will need node. Download the binaries from [the website](http://nodejs.org/download/)

Then you need bower:

`npm install -g bower`

Then you need grunt-cli

`npm install -g grunt-cli`

--

To install a project built with this template, run:

`bower install <user>/<repo>`

e.g.

`bower install adambom/builder`

This will clone all the project assets and dependencies into your working directory.

Then you will need to install all the npm dependencies:

`npm install`

You should be good to go. Run `grunt` to enter development mode. This will build your project and start up a 
development webserver.

Your server should be listening on [http://localhost:9001](http://localhost:9001).

# Grunt Tasks

Grunt is used for all project build tasks.

## Development:
The default grunt task can be run using the command:

`grunt`

This is what you will be running most of the time during development.

This does a number of things:
 1. Generates the index.html file for your project
 2. Compiles your less
 3. Copies files into web
 4. Runs jasmine unit tests
 5. Builds a dependency tree of all javascript modules using mantri
 6. Validates your javascript source against the rules specified in .jshintrc
 7. Runs a webserver at http://localhost:9001
 8. Watches the entire source for changes, and recompiles if needed. The web page should refresh automatically

## Production Build
The grunt task to build the project for production is:

`grunt dist`

This executes the following tasks:
 1. Builds a minified index.html in dist
 2. Compiles and minifies your less
 3. Validates your javascript source against the rules specified in .jshintrc
 4. Runs jasmine unit tests
 5. Builds, concatenates, and minifies your javascript using mantri
 6. Moves everything into dist

# Mantri

# Overall project structure

The project is organized into several directories for separation of concerns. Some directories will be 
autogenerated. These are **not** in source control, and have been ignored using .gitignore. These autogenerated 
directories are:

 - bower_components: Client-side libraries that are dependencies of the project. These are specified in bower.json. To add additional client libs, run `bower install <your-lib>[#<semver-tag>] --save-dev`
 - node_modules: Node libraries that are used for various build and development tasks. The depenedencies are specified in package.json. To add additional development libs run `npm install <your-lib>[#<semver-tag>] --save-dev`
 - web: This is the webroot for your development server. **DO NOT EDIT THE FILES IN THIS DIRECTORY**. They are autogenerated by the build script and you will lose any and all changes here.
 - dist: This is the target for production builds. **DO NOT EDIT THE FILES IN THIS DIRECTORY**. They are autogenerated by the build script and you will lose any and all changes here. When you run `grunt production` your project will be built, minified and placed here. These files are ready to be deployed.
 - .grunt: This is needed by grunt for running certain tasks. You can safely ignore this directory

## src
This is where all your source code should go. This directory should have one subdirectory for each language used.
By default, it has js, less, and tpl. The build script will watch for changes to these files and execute tasks based
on the file type.

## test
This is where your unit tests go. By default, the build script expects your tests to run with Jasmine in phantomjs.
If you want to change to a different testing framework, you will need to modify the build script.

Spec files should take the form `*-spec.js`. If it's named with that format, it will be run! If it's not named that 
way then don't expect your test to run.

In general, you should have one spec file for each module, and their names should match. For example:

```
Source: src/models/person-model.js
Test: test/models/person-model-spec.js
```

## config
This directory contains certain configuration files which are used for the build. There are two mantri
files here: `mantriConf.dev.json` and `mantriConf.dist.json`. These are used to configure builds for dev
and production, respectively. These are used to provide information to the mantri compiler about where 
project assets are located. More on this in the mantri section.

There are also at least two other config files in this directory. These are used to configure custom builds
of libraries such as lodash and modernizr in cases where you don't want to ship the whole library in production.

Documentation about the options for these config files is available at the links below:
 - Modernizr: https://github.com/Modernizr/grunt-modernizr
 - Lodash: https://github.com/lodash/grunt-lodash

## web (autogenerated)
**DO NOT EDIT THE FILES IN THIS DIRECTORY. YOUR CHANGES WILL BE LOST**

This directory is autogenrated by running the default `grunt` task. It contains all of your unminified and
unoptimized web assets. The build script sets up a web server running on port 9001 and serves up the files in
this directory. When you change a src file, the page will automatically reload.

## dist (autogenerated)
**DO NOT EDIT THE FILES IN THIS DIRECTORY. YOUR CHANGES WILL BE LOST**

This directory is autogenrated by running the `grunt dist` task. It will all of your minified and optimized 
web assets. The files in this directory are meant to be deploy-ready.

## .csslintrc
Specifies the rules to apply to validating css. Not currently in use.

## .jshintignore
These are files that you want jshint to ignore when validating your javascript.

## .jshintr
The rules for validating the project javascript. If your code fails to validate against these rules, you will break
the build, so remeber to follow the javascript style guidelines. The full list of configuration options can be found 
[here](http://www.jshint.com/docs/options/).

## bower.json
This file specifies all the information about your project. Most importantly it contains a list of dependencies 
for your front-end code. You can run `bower install` to install all dependencies.

## Gruntfile.js
All of the build tasks

## package.json
All off the development dependencies, such as grunt, and its associated plugins.
